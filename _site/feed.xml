<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xml" href="http://0.0.0.0:4000/feed.xslt.xml"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh"><generator uri="http://jekyllrb.com" version="3.3.0">Jekyll</generator><link href="http://0.0.0.0:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://0.0.0.0:4000/" rel="alternate" type="text/html" hreflang="zh" /><updated>2018-03-21T22:38:09+08:00</updated><id>http://0.0.0.0:4000//</id><title type="html">Ryan Wang’s blog</title><subtitle>Ryan Wang's Blog
</subtitle><author><name>Ryan Wang (Haide1977)</name><email>haide1977 AT gmail.com</email></author><entry><title type="html">场景式的研究工具箱杂论</title><link href="http://0.0.0.0:4000/2017/12/16/research_resources.html" rel="alternate" type="text/html" title="场景式的研究工具箱杂论" /><published>2017-12-16T00:00:00+08:00</published><updated>2017-12-16T00:00:00+08:00</updated><id>http://0.0.0.0:4000/2017/12/16/research_resources</id><content type="html" xml:base="http://0.0.0.0:4000/2017/12/16/research_resources.html">&lt;p&gt;最近开始接触全新的目标问题域，成果暂时还是空白。在梳理研究思路的同时，顺便整理了一下辅助工具和网站。&lt;/p&gt;

&lt;p&gt;欲善其事，先利其器。&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;section&quot;&gt;▸先给研究起个好代号吧&lt;/h2&gt;
&lt;p&gt;给关键技术、平台或者项目起个好代号，利于沟通。名正才能言顺。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://acronymify.com/&quot;&gt;acronymify.com&lt;/a&gt;&lt;br /&gt;
提供一段关键词，网站会自动创造一个系列候选缩写，选上一个满意的。 
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216acronymify.png-m640?v=11188&quot; alt=&quot;acronymify.com&quot; title=&quot;自动起名列表&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-1&quot;&gt;▸利用研究管理平台&lt;/h2&gt;
&lt;p&gt;研究平台，让研究更有条理。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.mendeley.com/&quot;&gt;mendeley.com&lt;/a&gt;  &lt;br /&gt;
免费的研究管理平台，包括文献索引管理和学术社交网络（号称600万学术研究用户）等。 &lt;br /&gt;
涵盖了知名的商业工具EndNote的部分功能。提供支持Windows、MacOS操作系统的桌面程序以及ios、android的app。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.researchgate.net&quot;&gt;ResearchGate.net&lt;/a&gt;&lt;br /&gt;
更专业的平台,注册账号要通过审核，需要你提供材料【推荐人／过去发表的研究成果】来证明自己不是打酱油的，而是真的在从事研究工作。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://scholar.google.com&quot;&gt;scholar.google.com&lt;/a&gt;   &lt;br /&gt;
google学术，通过收藏检索结果，快速建立自己的文献库。加标签、额外内容编辑关联以及批量下载索引都是很实用的功能。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-2&quot;&gt;▸先看看外面世界的状况&lt;/h2&gt;
&lt;p&gt;先了解问题域研究的发展趋势和脉络，既可避免一头扎进细节里，又可避免重复造轮子。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://trend.cnki.net/&quot;&gt;trend.cnki.net&lt;/a&gt;     &lt;br /&gt;
cnki上的专业名词的翻译助手和名词定义，也是不错的资源。
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216cnki.png-m640?v=11188&quot; alt=&quot;trend.cnki.net&quot; title=&quot;Cnki学术趋势&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://wanfangdata.com.cn&quot;&gt;万方&lt;/a&gt; &lt;br /&gt;
万方支持&lt;strong&gt;导出&lt;/strong&gt;功能和&lt;strong&gt;自动参考文献格式&lt;/strong&gt;生成，可以顺便搜集，以便未来下载和引用。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216wanfang.png-m640?v=11188&quot; alt=&quot;万方上的研究趋势曲线&quot; title=&quot;万方上的研究趋势曲线&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216wanfang3.png-m640?v=11188&quot; alt=&quot;标准参考引用格式生成&quot; title=&quot;标准参考引用格式生成&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.semanticscholar.org/&quot;&gt;semanticscholar.org&lt;/a&gt;    &lt;br /&gt;
将作者信息与知名的社交媒体做了关联。对引用做了影响力的自动评估。检索能力强。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-3&quot;&gt;▸切入正题，开始看文献。&lt;/h2&gt;
&lt;p&gt;除了大学、公共图书馆的一些免费资源的下载入口，对于一般的中文期刊文献，如果不能从scholar.google.com 上找到全文。那么只能考虑购买或者写邮件找作者索要了。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;英文文献的全文传送门&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;传说中的 &lt;strong&gt;sci-hub&lt;/strong&gt;，访问方式需要不停的变换，这里不推荐了。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.semanticscholar.org/&quot;&gt;semanticscholar.org&lt;/a&gt;  【前文已经提到】&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://gen.lib.rus.ec/&quot;&gt;library genesis&lt;/a&gt;  &lt;br /&gt;
除了全文下载，也有检索关键词的文献趋势查询。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216librarygenesis.png-m640?v=11188&quot; alt=&quot;library genesis&quot; title=&quot;library genesis首页&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;专业技术书籍下载&lt;/strong&gt; &lt;br /&gt;
- &lt;a href=&quot;http://en.booksee.org&quot;&gt;booksee.org&lt;/a&gt; 及 &lt;a href=&quot;http://booksc.org&quot;&gt;booksc.org&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;一般电子书、普通工具类技术文档下载地址实在太多了…最大的问题是看不过来。&lt;/p&gt;

&lt;h2 id=&quot;section-4&quot;&gt;▸数学计算与公式&lt;/h2&gt;
&lt;p&gt;没有一堆眼花缭乱的公式，你都不好意思出门说自己研究有深度，理论有高度。
有了辅助工具网站，可以节省不少复习数学的时间。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.numberempire.com/&quot;&gt;numberempire.com&lt;/a&gt;&lt;br /&gt;
各类数值计算器和编辑器，包括LaTex的编辑器。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216numberempire.png-m640?v=11188&quot; alt=&quot;numberempire函数大全&quot; title=&quot;numberempire函数大全&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.derivative-calculator.net/&quot;&gt;derivative-calculator.net&lt;/a&gt;  &lt;br /&gt;
导数计算 ，包括高阶导数的求导。有步骤及图形化的结果展示和导出。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216derivative.png-m640?v=11188&quot; alt=&quot;可视化求导&quot; title=&quot;可视化求导&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;支持导出LaTex表达式。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216derivative2.png-m640?v=11188&quot; alt=&quot;导出LaTex&quot; title=&quot;导出LaTex&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-5&quot;&gt;▸数据源&lt;/h2&gt;
&lt;p&gt;这个主题很大。不同的研究方向都会有一套自己的实验数据源。比如，做AI人脸识别，需要人脸库。
做流行病预测研究，需要多个维度的疾病登记数据；做智能投顾，需要证券市场的交易数据等。&lt;/p&gt;

&lt;p&gt;所幸，作为研究来说，网络上可以找到的免费数据源基本足够支撑。&lt;/p&gt;

&lt;p&gt;这里只是随便罗列几个例子：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://data.gov/&quot;&gt;data.gov&lt;/a&gt;  &lt;br /&gt;
美国政府数据开放平台。政府数据开放的一个好榜样。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://data.stats.gov.cn/&quot;&gt;data.stats.gov.cn&lt;/a&gt;&lt;br /&gt;
国家统计局的官方网站数据源【最小时间跨度为月度】&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216nationalstatistics.png-m640?v=11188&quot; alt=&quot;国家统计局数据源&quot; title=&quot;国家统计局数据源&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.ecmwf.int/&quot;&gt;ecmwf.int&lt;/a&gt;    &lt;br /&gt;
欧洲中期气候预报&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;不展开了…&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-6&quot;&gt;▸学术写作的语言辅助&lt;/h2&gt;
&lt;p&gt;要开始写东西，英文不熟练怎么办？&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;词语搭配查询   &lt;br /&gt;
&lt;a href=&quot;http://linggle.com/&quot;&gt;linggle.com&lt;/a&gt; 和 &lt;a href=&quot;http://www.netspeak.org/&quot;&gt;netspeak.org&lt;/a&gt;    &lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216lingglenetspeak.png-m640?v=11188&quot; alt=&quot;linggle &amp;amp; netspeak &quot; title=&quot;linggle &amp;amp; netspeak&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;【其实，“有道”字典里的例句功能，也是非常好的参考。】&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;在线学术写作  &lt;br /&gt;
&lt;a href=&quot;https://www.overleaf.com/&quot;&gt;overleaf.com&lt;/a&gt;  丰富的排版模板，所见即所得的在线编辑，方便的文档生成和分享。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20171216overleaf.png-m640?v=11188&quot; alt=&quot;linggle &amp;amp; netspeak &quot; title=&quot;linggle &amp;amp; netspeak&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;终于折腾出点头绪了&lt;/strong&gt;&lt;br /&gt;
不要着急着高兴，苦难才刚刚开始…&lt;/p&gt;</content><author><name>Ryan Wang (Haide1977)</name><email>haide1977 AT gmail.com</email></author><category term="方法杂论" /><category term="工具箱" /><summary type="html">最近开始接触全新的目标问题域，成果暂时还是空白。在梳理研究思路的同时，顺便整理了一下辅助工具和网站。

欲善其事，先利其器。</summary></entry><entry><title type="html">Road_to_https 既有系统的https的改造</title><link href="http://0.0.0.0:4000/2016/12/09/Road_to_https.html" rel="alternate" type="text/html" title="Road_to_https 既有系统的https的改造" /><published>2016-12-09T00:00:00+08:00</published><updated>2016-12-09T00:00:00+08:00</updated><id>http://0.0.0.0:4000/2016/12/09/Road_to_https</id><content type="html" xml:base="http://0.0.0.0:4000/2016/12/09/Road_to_https.html">&lt;h2 id=&quot;section&quot;&gt;提要&lt;/h2&gt;

&lt;h3 id=&quot;section-1&quot;&gt;研究目标&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;整理 https 相关的基本知识；&lt;/li&gt;
  &lt;li&gt;梳理现存网站全面转向 https 的相关行动事项&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-2&quot;&gt;主要内容&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;相关名词和基本知识&lt;/li&gt;
  &lt;li&gt;简明的行动项清单&lt;/li&gt;
  &lt;li&gt;重点技术项的细化阐述，包括证书，性能改善等&lt;/li&gt;
  &lt;li&gt;一些行动建议&lt;/li&gt;
&lt;/ul&gt;

&lt;!--more--&gt;
&lt;p&gt;## 引子 &lt;br /&gt;
如果你对这个课题还没有什么&lt;strong&gt;感性认识&lt;/strong&gt;，为了避免一开始就掉入过于枯燥、抽象的技术名词的泥沼，建议先试试以下两个事情：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;使用chrome 或 Firefox 桌面（非手机端）浏览器，打开下面几个网站：&lt;br /&gt;
第一组：&lt;a href=&quot;http://github.com&quot;&gt;http://github.com&lt;/a&gt;  ，&lt;a href=&quot;http://wallstreetcn.com&quot;&gt;http://wallstreetcn.com&lt;/a&gt; 或 &lt;a href=&quot;http://qiniu.com&quot;&gt;http://qiniu.com&lt;/a&gt; ; &lt;br /&gt;
第二组：&lt;a href=&quot;http://data.stats.gov.cn/&quot;&gt;http://data.stats.gov.cn/&lt;/a&gt; 或 &lt;a href=&quot;http://www.cbrc.gov.cn/&quot;&gt;http://www.cbrc.gov.cn/&lt;/a&gt;  &lt;br /&gt;
可以从地址栏上看到明显的返回结果的差异。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20161209github.png-m640&quot; alt=&quot;github地址栏&quot; title=&quot;github地址栏&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;尝试访问 &lt;a href=&quot;https://www.ssllabs.com/ssltest/index.html&quot;&gt;第三方SSL 测试平台&lt;/a&gt; &lt;br /&gt;
检测前面域名，也可以看到不同的测试结果返回。&lt;br /&gt;
&lt;img src=&quot;http://p1wq6a0o4.bkt.clouddn.com/20161209wallstreetcn.png-m640&quot; alt=&quot;sslLABS测试wallstreetcn.com结果&quot; title=&quot;sslLABS测试wallstreetcn.com结果&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;建议&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;如果现在对整个事情的全貌有兴趣，你可以现在先阅读&lt;a href=&quot;#section-7&quot;&gt;第二部分 开始行动&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;section-3&quot;&gt;一 基础知识&lt;/h2&gt;

&lt;h3 id=&quot;section-4&quot;&gt;1.1 部分名词&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;CSP:&lt;br /&gt;
(Content Security Policy) ,http 响应头。用来告诉浏览器，在当前页面采用何种内容安全策略。 可减轻内容注入的风险，降低应用执行的权限，提升安全的 “ 厚度 ” 。但不是防御内容注入的首选。&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;：&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;[Content Security Policy Level 3 的W3 官方文档]&lt;sup id=&quot;fnref:CSPl3&quot;&gt;&lt;a href=&quot;#fn:CSPl3&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;sample from w3.org：&lt;/em&gt; &lt;br /&gt;
  Given a page with the following Content Security Policy:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  
  Content-Security-Policy: child-src https://example.com/  
   
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;Fetches for the following code will all return network errors, as the URLs provided do not match child-src’s source list:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &amp;lt;iframe src=&quot;https://not-example.com&quot;&amp;gt;&amp;lt;/iframe&amp;gt;
  &amp;lt;script&amp;gt;
   var blockedWorker = new Worker(&quot;data:application/javascript,...&quot;);
  &amp;lt;/script&amp;gt;
 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Ocsp:&lt;br /&gt;
在线证书状态检查协议 (RFC6960 ) ，用来向 CA 站点查询证书状态，比如是否撤销。通常情况下，浏览器使用 OCSP 协议发起查询请求， CA 返回证书状态内容，然后浏览器接受证书是否可信的状态。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;HSTS ：&lt;br /&gt;
(HTTP  Strict Transport Security)  a way for sites to elect to always use HTTPS 。 http 协议响应头。要求浏览器通过 https 来访问网站。
避免用户试图用 “http://” 访问时，通过 Web Server 的 301/302 重定向到 “https:// “ 方式（节省一个 RTT ）。
&lt;strong&gt;需要浏览器支持&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;RTT ：&lt;br /&gt;
(round trip time ) （网络协议）交互时间&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;SPDY :&lt;br /&gt;
（ means  SPEEDY ）。 Google 开发的，为了改善 Http1.x 的 TCP 应用层协议。 修改了 HTTP 的请求与应答在网络上传输的方式，当使用 SPDY 的方式传输， HTTP 请求会被处理、标记简化和压缩。 关键特性已被吸收到了 HTTP/2 协议中。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-5&quot;&gt;1.2 规避已知的风险&lt;/h3&gt;

&lt;h4 id=&quot;section-6&quot;&gt;§ 漏洞及风险&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;规避已知的 HeartBleed 漏洞的涉及协议及产品版本  &lt;br /&gt;
2014 年 4 月漏洞暴露。    &lt;br /&gt;
对 2014 年 4 月前发布的基础系统，都要上官网确认是否存在安全漏洞，确认安装了必要的安全补丁。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;明确知道存在漏洞的基础系统（部分）    &lt;br /&gt;
centos  6 系列（ 6.5 ， 6.6 及以后，不含 7 以后） 涉及到 HeartBleed , 还包括 Shellshock, PODDLE 漏洞。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[Cent OS 官方对 HeartBleed ,PODDLE的安全说明] &lt;sup id=&quot;fnref:HeadBleed&quot;&gt;&lt;a href=&quot;#fn:HeadBleed&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;存在漏洞的协议  &lt;br /&gt;
OpenSSL 版本为 1.0.1 至 1.0.1f （含）。较新版本（ 1.0.1g 以上）及先前版本（ 1.0.0 分支以前）不受影响。 OpenSSL 最新版本 1.1.0c （ 2016-11-10 发布） 
SSL3.0 （ POODLE 攻击）， TLS1.0 （ 如 RC4 和 BEAST 攻击 ）&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[Turn off SSL3.0 and TLS 1.0] &lt;sup id=&quot;fnref:SSL3&quot;&gt;&lt;a href=&quot;#fn:SSL3&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;已知的加密算法的风险
    &lt;ul&gt;
      &lt;li&gt;MD5  ， SHA － 1 ，都不再适合用于密钥交换和加密通信（一致性校验）&lt;/li&gt;
      &lt;li&gt;RSA 算法需要使用 2048bit 或以上的密钥才能保证安全性（ 1024bit 密钥已经不再安全）&lt;/li&gt;
      &lt;li&gt;ECC 算法需要 224bit 以上的密钥才能保证安全性（通常为 256bit ）&lt;/li&gt;
      &lt;li&gt;RC4 （伪随机数流加密算法），已经在新版本 TLS 中被禁用   。&lt;br /&gt;
  google 使用的 ChaCha20 已经在 RFC 7539 中标准化  ,性能较之AES-GCM更好&lt;/li&gt;
      &lt;li&gt;TLS1.1 ， TLS1.2 尚未发现安全漏洞。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt; :&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[ 建议用 AES-GCM 取代RC4 ] &lt;sup id=&quot;fnref:AES-GCM&quot;&gt;&lt;a href=&quot;#fn:AES-GCM&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; &lt;br /&gt;
[ 通俗版椭圆曲线算法理论 ]&lt;sup id=&quot;fnref:pediy6014&quot;&gt;&lt;a href=&quot;#fn:pediy6014&quot; class=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;section-7&quot;&gt;§ 针对协议与算法的常见攻击&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;BEAST:&lt;br /&gt;
  ( Browser Exploit Against SSL/TLS)&lt;br /&gt;
 利用块加密的特性，破解出密文中的某块明文，比如 cookies 中的 SessionKey 。
  TLS1.1 以后的版本已经修正了风险。但是攻击者可以通过 Downgrade Attack （参见：降级攻击）来试图迫使客户端降到 TLS1.0 来实施攻击。&lt;br /&gt;
&lt;strong&gt;参考&lt;/strong&gt;：&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;[ 一篇通俗易懂的 BEAST 原理的 BLOG ]&lt;sup id=&quot;fnref:BEAST&quot;&gt;&lt;a href=&quot;#fn:BEAST&quot; class=&quot;footnote&quot;&gt;6&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;Downgrade Attack 降级攻击&lt;br /&gt;
 包括： 降级攻击一般包括两种：加密套件降级攻击 (cipher suite rollback) 和协议降级攻击（ version roll back ）。  &lt;br /&gt;
降级攻击的原理就是攻击者伪造或者修改 client hello 消息，使得客户端和服务器之间使用比较弱的加密套件或者协议完成通信。&lt;br /&gt;
&lt;strong&gt;参考&lt;/strong&gt;：&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;[ 利用 TLS_FALLBACK_SCSV 协议值来防止降级攻击 ]&lt;sup id=&quot;fnref:TLS_FB&quot;&gt;&lt;a href=&quot;#fn:TLS_FB&quot; class=&quot;footnote&quot;&gt;7&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;HeartBleed&lt;sup id=&quot;fnref:HeadBleed:1&quot;&gt;&lt;a href=&quot;#fn:HeadBleed&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;：  &lt;br /&gt;
 Heartbleed 是存在于 OpenSSL 加密软件库内的一个严重漏洞。此弱点让受保护的信息可以被盗取，它们本来是受 SSL ／ TLS 互联网加密协议所保护的。 SSL ／ TLS 为互联网上的应用程序提供安全通讯及私隐，这些程序包括有网页、电邮、即时通讯（ IM ）及某些虚拟专用网络（ VPN ）。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;POODLE:&lt;br /&gt;
（ Padding Oracle On Downgraded Legacy Encryption ）。是协议降级攻击 version roll back 方式的一种。迫使浏览器降级至 SSL 3.0 而进行的中间人攻击。假若攻击者能成功利用此漏洞，他们平均只需 256 个 SSL 3.0 请求便能看穿加密信息内的 1 个字符。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;TLS Renegotiation 重新协商攻击&lt;br /&gt;
 包括： 
 加密套件重协商 (cipher suite renegotiation )、 协议重商攻击（ Protocol Renegotiation ）两类。&lt;br /&gt;
&lt;strong&gt;最直接的保护手段是禁止客户端发起主动重新协商&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[Understanding_the_TLS_Renegotiation ]&lt;sup id=&quot;fnref:TLS_Ren&quot;&gt;&lt;a href=&quot;#fn:TLS_Ren&quot; class=&quot;footnote&quot;&gt;8&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;XSS  攻击  &lt;br /&gt;
（ Cross-Site Scripting ）跨域脚本攻击   。在目标网站上执行非目标网站的原有脚本 。
既有利用浏览器漏洞，也有利用代码的漏洞进行脚本注入。通过 https 和响应头设置，可以减少
XSS 发生的可能。&lt;br /&gt;
&lt;strong&gt;参见服务端响应头相关内容&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-8&quot;&gt;二 开始行动&lt;/h2&gt;

&lt;h3 id=&quot;section-9&quot;&gt;2.1 首先要澄清的几个事项&lt;/h3&gt;

&lt;h4 id=&quot;https-&quot;&gt;§ 把域名切换到 https ，只是切换工作的一小部分&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;部署证书、修改 WebServer 配置支持 https 只是开始&lt;/li&gt;
  &lt;li&gt;所需加载的资源，如 js ， css ，图片等都需要加入考量范畴。否则，依旧存在劫持的可能。&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;https--1&quot;&gt;§ https 的改造可以不考虑内部系统之间的调用&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;但是，如果是跨局域网的内部服务间的交互，我们需要考虑敏感信息在链路上的安全&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;cdn-&quot;&gt;§ 如果所需加载资源利用了第三方服务，如 CDN ，那么要做方案上的决策。&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;信任 CDN ？ 把私钥交给 CDN ？&lt;br /&gt;
 &lt;strong&gt;相信 CDN 是安全的,这一行为本身就是不安全的。&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;仅利用 CDN 的动态加速， TCP 代理，不缓存内容？  &lt;br /&gt;
 &lt;strong&gt;这样就大大降低了 CDN 的价值。&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;寻找类似 CloudFlare ，提供 Keyless SSL 服务的 CDN 服务商。&lt;sup id=&quot;fnref:CloudF&quot;&gt;&lt;a href=&quot;#fn:CloudF&quot; class=&quot;footnote&quot;&gt;9&lt;/a&gt;&lt;/sup&gt;     &lt;br /&gt;
&lt;strong&gt;不用提供私钥，不用使用公共域名和证书&lt;/strong&gt; &lt;br /&gt;
&lt;strong&gt;CloudFare 已经与百度合作&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;http--https-&quot;&gt;§ 把资源先改成 http 和 https 都支持？？&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;注意修改代码中的链接 , 协议无关地址（ Protocol-less URLs ）。    &lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;href=\&quot;http://...\&quot;    改为   href=\&quot;//...\&quot;&lt;/code&gt;             &lt;br /&gt;
&lt;strong&gt;问题：存在不兼容的可能，上线前需要严格测试&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;https--http-&quot;&gt;§ https 下重建连接的代价成本要远比 http 高&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;http/2 的头部压缩（ header compression ） , 连接多路复用（ one connection for parallelism ）等可以改善 TLS 带来的成本。  &lt;br /&gt;
&lt;strong&gt;目前平均每个页面有 80 个部件 (Assets) ，平均每个头 (Header) 有 1400bytes&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;http/2 可以完全兼容 http1.1&lt;br /&gt;
&lt;strong&gt;参考&lt;/strong&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;[HTTP2 的 FAQ]&lt;sup id=&quot;fnref:HTTP2&quot;&gt;&lt;a href=&quot;#fn:HTTP2&quot; class=&quot;footnote&quot;&gt;10&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;section-10&quot;&gt;§ 必须关注证书采购的成本&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;购买证书的投入，包括首次购买及续费成本&lt;/li&gt;
  &lt;li&gt;未来运维管理的成本&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;server-&quot;&gt;§  协议支持的，未必代表厂商（浏览器， Server 等）支持&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;必须要用特定的配置（兼容）清单 去验证所有的修改&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;step-by-step&quot;&gt;2.2 主要行动Step by Step&lt;/h3&gt;

&lt;h4 id=&quot;step1-ca&quot;&gt;§ Step1 申请（购买）CA证书&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;需要根据自身业务使用域名的实况来确定采购的证书类型和数量。&lt;br /&gt;
对现有域名资源进行适当的梳理和规划，可以节省证书和未来运维的成本。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;DV(Domain Validation SSL Certificate ) ,OV( Organization Validation SSL Certificate ),EV(  Extended Validation SSL Certificate )  与保护的域名数量之间没有直接关联&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;SAN SSL 证书   Subject Alternative Name certificates 又称为 UCC 证书 – Unified Communication Certificates. &lt;br /&gt;
  可以保护若干数量的域名。超过默认数量，可能需要支付额外费用 。   （具体视厂商而定）&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;通配符 证书   Wildcard SSL  Certificate    ， 也称为泛域名证书，&lt;br /&gt;
 可以保护下一级的子域名，及其本身。  &lt;br /&gt;
 即：如要保护多个四级域名，需要购买针对三级域名的通配符型的证书。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;不同的 CA 证书供应商，价格差异较大。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;正在兴起的 &lt;strong&gt;Let’s Encrypt&lt;/strong&gt;免费证书&lt;sup id=&quot;fnref:Letsen&quot;&gt;&lt;a href=&quot;#fn:Letsen&quot; class=&quot;footnote&quot;&gt;11&lt;/a&gt;&lt;/sup&gt; , &lt;sup id=&quot;fnref:acme-tiny&quot;&gt;&lt;a href=&quot;#fn:acme-tiny&quot; class=&quot;footnote&quot;&gt;12&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;示例：&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;如：需要保护类似 ＊ .weixin.example.com , ＊ .api.weixin.example.com ，以及上层的 example.com 和 ＊.example.com&lt;br /&gt;
&lt;strong&gt;【需要两张泛域名证书】&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;step2--&quot;&gt;§ Step2  生成和下载证书&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;证书供应商会都会提供管理和生成、下载证书的管理入口&lt;/li&gt;
  &lt;li&gt;每张证书都是和特定的一个或者一组域名的保护相关联（生成）的&lt;/li&gt;
  &lt;li&gt;将下载证书部署到服务端特定的位置&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;step3-cipher-suite&quot;&gt;§ Step3 选择加密套件Cipher Suite&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;每个利用 https 的客户端都有一组支持的加密套件（ Cipher Suite ），&lt;br /&gt;
如果这组套件与服务器上的套件列表没有交集，则无法完成协商，握手失败。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;每个套件都是一组算法存在的，其中一般包含：&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;密钥交换（ Key Exchange ）&lt;/li&gt;
      &lt;li&gt;证书签名认证（ Authentication ）&lt;/li&gt;
      &lt;li&gt;加密算法（ Encrytion ）&lt;/li&gt;
      &lt;li&gt;内容完整性（一致性）校验算法（ Message Authentication Code ，简称 MAC ）&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;[iana.org 管理的完整套件列表 ]&lt;sup id=&quot;fnref:iana&quot;&gt;&lt;a href=&quot;#fn:iana&quot; class=&quot;footnote&quot;&gt;13&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;openssl 不同版本支持的套件不同，可以通过命令查看：  &lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt; $ openssl ciphers -V | column -t&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;命令运行后，展现以下形式内容 , 其中第一列为套件的编号：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  0xC0,0x30  -  ECDHE-RSA-AES256-GCM-SHA384    TLSv1.2  Kx=ECDH        Au=RSA    Enc=AESGCM(256)    Mac=AEAD  
  0xC0,0x2C  -  ECDHE-ECDSA-AES256-GCM-SHA384  TLSv1.2  Kx=ECDH        Au=ECDSA  Enc=AESGCM(256)    Mac=AEAD  
  0xC0,0x28  -  ECDHE-RSA-AES256-SHA384        TLSv1.2  Kx=ECDH        Au=RSA    Enc=AES(256)       Mac=SHA384  
  0xC0,0x24  -  ECDHE-ECDSA-AES256-SHA384      TLSv1.2  Kx=ECDH        Au=ECDSA  Enc=AES(256)       Mac=SHA384  
  0xC0,0x14  -  ECDHE-RSA-AES256-SHA           SSLv3    Kx=ECDH        Au=RSA    Enc=AES(256)       Mac=SHA1  
  0xC0,0x0A  -  ECDHE-ECDSA-AES256-SHA         SSLv3    Kx=ECDH        Au=ECDSA  Enc=AES(256)       Mac=SHA1  
  0xC0,0x22  -  SRP-DSS-AES-256-CBC-SHA        SSLv3    Kx=SRP         Au=DSS    Enc=AES(256)       Mac=SHA1  
....  

&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;非对称密钥交换算法 key Exchange 。    &lt;br /&gt;
建议优先使用 ECDHE ，禁用 DHE ，次优先选择 RSA 。&lt;/li&gt;
    &lt;li&gt;证书签名算法 。  &lt;br /&gt;
由于部分浏览器及操作系统不支持 ECDSA 签名，目前默认都是使用 RSA 签名，其中 SHA1 签名已经不再安全， &lt;strong&gt;chrome 及微软 2016 年开始不再支持 SHA1 签名的证书&lt;/strong&gt; &lt;sup id=&quot;fnref:SHA1&quot;&gt;&lt;a href=&quot;#fn:SHA1&quot; class=&quot;footnote&quot;&gt;14&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
    &lt;li&gt;对称加解密算法。    &lt;br /&gt;
优先使用 AES-GCM 算法，针对 1.0 以上协议禁用 RC4 （rfc7465）。&lt;/li&gt;
    &lt;li&gt;内容一致性校验算法。    &lt;br /&gt;
Md5 和 SHA1 都已经不安全，建议使用 SHA256 等安全哈希函数。&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;step4--&quot;&gt;§ Step4  修改服务器配置&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;修改 Nginx 配置 （包括指定证书的路径）&lt;/li&gt;
  &lt;li&gt;是否在 Nginx 的配置中加入不同的响应头，需要小心评估。  &lt;br /&gt;
例如： 如下响应头可以自动将 http 资源请求，升级会 https 请求。&lt;br /&gt;
（需要保证资源路径相同，包括第三方资源可支持 https ）&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;W3.org上的例子 &lt;a href=&quot;https://www.w3.org/TR/upgrade-insecure-requests/&quot;&gt;https://www.w3.org/TR/upgrade-insecure-requests/&lt;/a&gt; :&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  server {
    ...

    add_header Content-Security-Policy upgrade-insecure-requests;

    ...
  }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;下载 openSSL 包&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;示例 &lt;a href=&quot;https://github.com/diafygi/acme-tiny &quot;&gt;https://github.com/diafygi/acme-tiny &lt;/a&gt; : &lt;sup id=&quot;fnref:acme-tiny:1&quot;&gt;&lt;a href=&quot;#fn:acme-tiny&quot; class=&quot;footnote&quot;&gt;12&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    server {  
      listen 443;  
      server_name yoursite.com, www.yoursite.com;   
      ssl on;  
      ssl_certificate /path/to/chained.pem;  
      ssl_certificate_key /path/to/domain.key;  
      ssl_session_timeout 5m;  
      ssl_protocols TLSv1.1 TLSv1.2;  
      ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA;  
      ssl_session_cache shared:SSL:50m;  
      ssl_dhparam /path/to/server.dhparam;  
      ssl_prefer_server_ciphers on;   
      ...the rest of your config  
    } 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;更多内容可参见后文 &lt;a href=&quot;#section-10&quot;&gt;重点行动项的进一步说明&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[ 官方 Module ngx_http_ssl_module]&lt;sup id=&quot;fnref:ngx_http&quot;&gt;&lt;a href=&quot;#fn:ngx_http&quot; class=&quot;footnote&quot;&gt;15&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;step5-&quot;&gt;§ Step5 修改代码&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;采用 https 协议 “https://…” ，或者改为 协议无关的方式 “ //…” &lt;br /&gt;
改为协议无关 “//…” 方式，是种很有风险的方式，存在网络供应商篡改，导致资源路径失败的可能&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;页面从存在任何不安全的链接（ http ），浏览器地址栏的小绿锁 就会消失。    &lt;br /&gt;
 **要去掉所有可能导致警告和绿锁消失的链接 **&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;注意可能从配置文件 或者 数据库字段中生成的 地址&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;注意所有的外链和外部接口&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;[Move a site with URL changes]&lt;sup id=&quot;fnref:Move&quot;&gt;&lt;a href=&quot;#fn:Move&quot; class=&quot;footnote&quot;&gt;16&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
    &lt;li&gt;[RFC3986]&lt;sup id=&quot;fnref:RFC3986&quot;&gt;&lt;a href=&quot;#fn:RFC3986&quot; class=&quot;footnote&quot;&gt;17&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;final-step--&quot;&gt;§ final Step  监控日志&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;必须关注和分析服务器日志，确定资源请求失败的客户端，或者资源本身。&lt;/li&gt;
  &lt;li&gt;监控日志，只是一轮改造的最后一步，更可能是新一轮迭代的开始。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-11&quot;&gt;三 重点行动项的进一步说明&lt;/h2&gt;

&lt;h3 id=&quot;section-12&quot;&gt;3.1 证书问题&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;通过 Nginx ，在同一 IP 上部署多个 HTTPS 站点，会存在证书冲突的问题   ，除了 SNI （ Server Name Indication ）外，利用 SAN 证书也可以解决这个问题    &lt;br /&gt;
&lt;strong&gt;Windows XP IE6~8 、 Android 2.x Webview 都不支持 SNI&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-13&quot;&gt;3.2 服务端响应头&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;参考示例&lt;/strong&gt;
可以参考和研究其它网站的响应头，然后结合自身实况来决定怎么做&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Google:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  x-content-type-options: nosniff  
  x-frame-options: SAMEORIGIN  
  x-xss-protection: 1 ; mode=block  

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Twitter:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  strict-transport-security: max-age= 631138519
  x-frame-options: SAMEORIGIN
  x-xss-protection: 1 ; mode=block
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;PayPal:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  X-Frame-Options: SAMEORIGIN
  Strict-Transport-Security: max-age= 14400
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Facebook 则使用了这些（配置了详细的 CSP ，关闭了 XSS 保护）:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  strict-transport-security: max-age= 60
  x-content-type-options: nosniff
  x-frame-options: DENY
  x-xss-protection: 0
  content-security-policy: default-src *;script-src https://*.facebook.com http://*.facebook.com https://*.fbcdn.net http://*.fbcdn.net *.facebook.net *.google-analytics.com *.virtualearth.net *.google.com 127.0 . 0.1 :* *.spotilocal.com:* chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl 'unsafe-inline' 'unsafe-eval' https://*.akamaihd.net http://*.akamaihd.net;style-src * 'unsafe-inline' ;connect-src https://*.facebook.com http://*.facebook.com https://*.fbcdn.net http://*.fbcdn.net *.facebook.net *.spotilocal.com:* https://*.akamaihd.net ws://*.facebook.com:* http://*.akamaihd.net https://fb.scanandcleanlocal.com:*;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;section-14&quot;&gt;3.3 让交互更快的策略&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;参考建议&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;采取任何优化策略前，先要对内部基础设施（包括web server，用户浏览器使用分布等），做清晰梳理。然后再寻找、评估和采用针对性的策略。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;tcp-fast-open&quot;&gt;§ TCP FAST OPEN&lt;/h4&gt;
&lt;p&gt;RFC7413&lt;br /&gt;
  TFO 需要高版本内核的支持， linux 从 3.7 以后支持 TFO ，但是目前的 windows 系统还不支持 TFO ，所以只能在公司内部服务器之间发挥作用。&lt;/p&gt;

&lt;h4 id=&quot;ocsp-stapling&quot;&gt;§ OCSP Stapling&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;OCSP 方式向 CA 站点检查证书状态请求， CA 返回证书状态（是否有效／可信／撤销等）的过程，会因为 CA 站点服务器的位置，网络的稳定性等因素，会额外消耗大量 RTT 的时间。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;OCSP 装订 /( 封套 ). 是一个 TLS 证书状态查询扩展，作为在线证书状态协议的代替方法对 X.509 证书状态进行查询   。
  服务器在 TLS 握手时发送事先缓存的 OCSP 响应，用户只需验证该响应的有效性而不用再向数字证书认证机构（ CA ）发送请求。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;服务器端的支持情况：&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;
  Httpd ： 2.3.3          
  Nginx ： 1.3.7  
  IIS ： Windows Server 2008  
  HAProxy ： 1.5.0  
&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;浏览器的支持情况：主流浏览器都已获得支持。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Nginx 开启配置的方式  &lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;ssl_stapling on;ssl_stapling_file ocsp.staple;
&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[OCSP_Stapling,wikipedia ]&lt;sup id=&quot;fnref:OCSP&quot;&gt;&lt;a href=&quot;#fn:OCSP&quot; class=&quot;footnote&quot;&gt;18&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;session--session--resume-&quot;&gt;§ Session 复用（ Session  Resume ）的两种方式&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Session Cache &amp;amp;  Session Ticket &lt;br /&gt;
通过在服务端缓存已有的 Session 握手信息来实现：避免再次计算和非对程密钥的交换，节省一个 RTT 交互时间和计算成本。&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;策略&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;存储方式&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;存储容量&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;恢复方式&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;共享能力&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;优缺点与风险&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;session cache&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务端内存&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4K session/M&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;通过 Session id 查找&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;单机多进程间&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;浏览器支持度高，不支持分布式，消耗内存&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;session ticket&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务端文件&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;通过 Session 本身（加密成 ticket ）&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;可以在多个 Server 间共享&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;支持度略低，需维护 ticket 加解密的额外 key&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;为了保证 Session Tickets 的可复用，在 配置Nginx 时不要使用 web server 随机生成的保存文件。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[nginx 官方 ssl_session_ticket_key]&lt;sup id=&quot;fnref:ticket&quot;&gt;&lt;a href=&quot;#fn:ticket&quot; class=&quot;footnote&quot;&gt;19&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;app&quot;&gt;3.4 APP周边相关&lt;/h3&gt;
&lt;p&gt;#### § 原生功能的安全
  - 仅使用 MD5 的 token 是很容易被伪冒的。对于涉及资金的交易，显然不够；  需要同时利用［敏感内容先加密（如 利用 RSA 算法），同时完整交易信息签名验证（比如利用 appKey+appSecret+userName+tradeTime
，进行 MD5 或者 SHA256 ）。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;进一步提高安全性： &lt;br /&gt;
  每天至少进行一次握手，交换和更新下 token （密钥）。&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;h5-&quot;&gt;§ 内嵌H5 页面的安全&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;可以选择高层或底层的不同方式&lt;br /&gt;
  （如 android 的 HttpsURLConnection ，或 SSLSocket ） &lt;br /&gt;
  &lt;strong&gt;参考&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://developer.android.com/training/best-security.html&quot;&gt;Android 官方 : Best Practices for  Security and Privacy&lt;/a&gt; &lt;sup id=&quot;fnref:Android&quot;&gt;&lt;a href=&quot;#fn:Android&quot; class=&quot;footnote&quot;&gt;20&lt;/a&gt;&lt;/sup&gt;   &lt;br /&gt;
&lt;a href=&quot;https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW33&quot;&gt;ios  官方： App Transport Security (ATS) &lt;/a&gt; &lt;sup id=&quot;fnref:ATS&quot;&gt;&lt;a href=&quot;#fn:ATS&quot; class=&quot;footnote&quot;&gt;21&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;section-15&quot;&gt;3.5 测试与验证&lt;/h3&gt;

&lt;h4 id=&quot;section-16&quot;&gt;§ 工具&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;免费的第三方检测平台。&lt;br /&gt;
如：&lt;a href=&quot;https://www.ssllabs.com/ssltest/index.html&quot;&gt;ssl Labs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-17&quot;&gt;五 结语&lt;/h2&gt;

&lt;p&gt;回到本文的最前面，如果你只是想让你的网站，在地址栏出现一个“小绿锁”（也许它会时隐时现），那么一切都比较简单。借助cloudflare 提供的服务，也许只要半个小时就看上去万事大吉了。&lt;/p&gt;

&lt;p&gt;但是，对于一个有一定规模的网站来说，向https 、 http/2 的切换，目标显然不仅是看上去有了个“小绿锁”。真正实现在安全层面的提升和切换，一定会是一个艰难和充满风险的过程。&lt;/p&gt;

&lt;h2 id=&quot;section-18&quot;&gt;六 延伸阅读&lt;/h2&gt;

&lt;h3 id=&quot;section-19&quot;&gt;6.1 来自其它公司的实践&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;大型网站的https实践(百度)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://op.baidu.com/2015/04/https-s01a01/&quot;&gt;http://op.baidu.com/2015/04/https-s01a01/&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;淘宝的https探索&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://velocity.oreilly.com.cn/2015/ppts/lizhenyu.pdf&quot;&gt;http://velocity.oreilly.com.cn/2015/ppts/lizhenyu.pdf&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;section-20&quot;&gt;6.2  其他链接&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.nginx.com/blog/nginx-1-9-5/&quot;&gt;nginx官方: Open Source Nginx 1.9.5  Released with  HTTP/2 support&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://segmentfault.com/a/1190000004232801&quot;&gt;nginx1.8.x 配置 https&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;参考索引汇总&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:CSPl3&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://www.w3.org/TR/CSP/&quot;&gt;Content Security Policy Level 3 的W3 官方文档&lt;/a&gt; &lt;a href=&quot;#fnref:CSPl3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:HeadBleed&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://wiki.centos.org/zh/Security&quot;&gt;Cent OS 官方对 HeartBleed ,PODDLE的安全说明&lt;/a&gt; &lt;a href=&quot;#fnref:HeadBleed&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt; &lt;a href=&quot;#fnref:HeadBleed:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:SSL3&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://www.ssl.com/how-to/turn-off-ssl-3-0-and-tls-1-0-in-your-browser/&quot;&gt;Turn off SSL3.0 and TLS 1.0&lt;/a&gt; &lt;a href=&quot;#fnref:SSL3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:AES-GCM&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://blogs.technet.microsoft.com/srd/2013/11/12/security-advisory-2868725-recommendation-to-disable-rc4/&quot;&gt; 建议用 AES-GCM 取代RC4 &lt;/a&gt; &lt;a href=&quot;#fnref:AES-GCM&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:pediy6014&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://www.pediy.com/kssd/pediy06/pediy6014.htm&quot;&gt; 通俗版椭圆曲线算法理论 &lt;/a&gt; &lt;a href=&quot;#fnref:pediy6014&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:BEAST&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://securityalley.blogspot.com/2014/07/ssltls-beast.html&quot;&gt;一篇通俗易懂的 BEAST 原理的 BLOG &lt;/a&gt; &lt;a href=&quot;#fnref:BEAST&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:TLS_FB&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00#page-3&quot;&gt;ietf: 利用 TLS_FALLBACK_SCSV 协议值来防止降级攻击 &lt;/a&gt; &lt;a href=&quot;#fnref:TLS_FB&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:TLS_Ren&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://www.educatedguesswork.org/2009/11/understanding_the_tls_renegoti.html&quot;&gt;Understanding_the_TLS_Renegotiation&lt;/a&gt; &lt;a href=&quot;#fnref:TLS_Ren&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:CloudF&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://www.cloudflare.com/ssl/&quot;&gt;Cloudflare one-click SSL&lt;/a&gt; &lt;a href=&quot;#fnref:CloudF&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:HTTP2&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://http2.github.io/faq/&quot;&gt;HTTP2的FAQ&lt;/a&gt; &lt;a href=&quot;#fnref:HTTP2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:Letsen&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://letsencrypt.org/getting-started/&quot;&gt;Let’s Encrypt 免费证书&lt;/a&gt; &lt;a href=&quot;#fnref:Letsen&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:acme-tiny&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/diafygi/acme-tiny&quot;&gt;issue and renew Let’s Encrypt certificates&lt;/a&gt; &lt;a href=&quot;#fnref:acme-tiny&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt; &lt;a href=&quot;#fnref:acme-tiny:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:iana&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4&quot;&gt;iana.org 管理的完整套件列表&lt;/a&gt; &lt;a href=&quot;#fnref:iana&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:SHA1&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://googleonlinesecurity.blogspot.jp/2014/09/gradually-sunsetting-sha-1.html&quot;&gt;chrome 及微软 2016 年开始不再支持 SHA1 签名的证书&lt;/a&gt; &lt;a href=&quot;#fnref:SHA1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:ngx_http&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://nginx.org/en/docs/http/ngx_http_ssl_module.html&quot;&gt;官方:配置 Module ngx_http_ssl_module &lt;/a&gt; &lt;a href=&quot;#fnref:ngx_http&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:Move&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://support.google.com/webmasters/answer/6033049?hl=en&amp;amp;ref_topic=6033084&amp;amp;rd=1&quot;&gt;Google:  Move a site with URL changes&lt;/a&gt; &lt;a href=&quot;#fnref:Move&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:RFC3986&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://tools.ietf.org/html/rfc3986#section-4.2&quot;&gt;RFC3986:(URI): Generic Syntax&lt;/a&gt; &lt;a href=&quot;#fnref:RFC3986&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:OCSP&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/OCSP_stapling&quot;&gt;OCSP_Stapling,wikipedia&lt;/a&gt; &lt;a href=&quot;#fnref:OCSP&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:ticket&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_session_ticket_key&quot;&gt;nginx官方：ssl_session_ticket_key&lt;/a&gt; &lt;a href=&quot;#fnref:ticket&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:Android&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://developer.android.com/training/best-security.html&quot;&gt;Android官方: Best Practices for  Security and Privacy&lt;/a&gt; &lt;a href=&quot;#fnref:Android&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:ATS&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW33&quot;&gt;ios 官方： App Transport Security (ATS) &lt;/a&gt; &lt;a href=&quot;#fnref:ATS&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Ryan Wang (Haide1977)</name><email>haide1977 AT gmail.com</email></author><category term="架构" /><category term="互联网" /><category term="基础系统" /><summary type="html">提要

研究目标

  整理 https 相关的基本知识；
  梳理现存网站全面转向 https 的相关行动事项


主要内容


  相关名词和基本知识
  简明的行动项清单
  重点技术项的细化阐述，包括证书，性能改善等
  一些行动建议</summary></entry><entry><title type="html">从零开始的平台总体安全体系的考量</title><link href="http://0.0.0.0:4000/2016/10/18/System_Security-Considerations_From_Scratch.html" rel="alternate" type="text/html" title="从零开始的平台总体安全体系的考量" /><published>2016-10-18T00:00:00+08:00</published><updated>2016-10-18T00:00:00+08:00</updated><id>http://0.0.0.0:4000/2016/10/18/System_Security%20Considerations_From_Scratch</id><content type="html" xml:base="http://0.0.0.0:4000/2016/10/18/System_Security-Considerations_From_Scratch.html">&lt;p&gt;现在互联网的新生平台比以往面临着更复杂的技术环境。平台一上线，即面临着全方位、体系性的安全风险考验。以如下几方面情况的引入，可能衍生的安全风险尤为突出：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;面向多种类型端的用户APP产品入口的推出&lt;/li&gt;
  &lt;li&gt;更加复杂的用户权益账户、储值类电子账户的引入， 如 &lt;strong&gt;积分、内置钱包等&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;平台自有的多个支付渠道和多类型收付交易行为的引入， 如 &lt;strong&gt;三方支付、交易中途改变支付方式等&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;更加复杂的结算和清算场景 ， 如 &lt;strong&gt;用户奖励提现，外部积分互换等&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;更加复杂的业务和个性化的促销策略， 如 &lt;strong&gt;折扣策略、优惠券和羊毛党等&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;以及，快速的业务场景和功能的演进。&lt;/li&gt;
&lt;/ul&gt;

&lt;!--more--&gt;

&lt;p&gt;对于很多新生的互联网业务平台来说，受制于诸多约束，多数时候是暴露在各类安全风险下前进的。本文并非要阐述如何建设一个高标准的、高等级的信息安全体系，而是，站在从零开始的场景下，梳理一个相对体系化的考量框架。毕竟，最大的风险是来自对风险的无知。如何在有限资源投入的情况下，作出各种权衡，使安全体系建设和平台发展演进相适应，才是我们真正要关注的。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;一 系统的总体安全目标&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;安全板块划分&lt;/th&gt;
      &lt;th&gt;总体目标&lt;/th&gt;
      &lt;th&gt;备注说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;运营&lt;/td&gt;
      &lt;td&gt;安全应急响应与风控体系&lt;/td&gt;
      &lt;td&gt;运营全流程及体系角度来统筹推进建设&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;基本防护&lt;/td&gt;
      &lt;td&gt;基本的安全攻防体系&lt;/td&gt;
      &lt;td&gt;提高系统被攻击的门槛&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;运维&lt;/td&gt;
      &lt;td&gt;安全管理与审计&lt;/td&gt;
      &lt;td&gt;合适权限的人和系统，访问合适权限的数据和服务&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;监控与告警&lt;/td&gt;
      &lt;td&gt;实时安全监控与安全扫描&lt;/td&gt;
      &lt;td&gt;如何及时发现问题；合理的确定告警项和等级&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;研发&lt;/td&gt;
      &lt;td&gt;安全软件的开发框架&lt;/td&gt;
      &lt;td&gt;使功能团队相对专注功能开发，引入安全风险的几率降低。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;section-1&quot;&gt;二 安全体系构建的基本思路&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;体系化建设推进，&lt;strong&gt;避免&lt;/strong&gt;出现安全板块的 &lt;strong&gt;明显短板&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;与产品与运营发展的相匹配，注重 &lt;strong&gt;投入产出比&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;关键在于 &lt;strong&gt;风险可控&lt;/strong&gt;，不断提升自我保护能力&lt;/li&gt;
  &lt;li&gt;不断提升攻击成本，控制、降低被攻击的损失&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;平衡&lt;/strong&gt;用户产品使用的便利性和安全性&lt;/li&gt;
  &lt;li&gt;不要混淆用户的 &lt;strong&gt;安全感诉求&lt;/strong&gt; 和真正的 &lt;strong&gt;系统安全需求&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;借鉴和研发并举， &lt;strong&gt;避免闭门造车&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-2&quot;&gt;三 安全角度的非功能性需求建设&lt;/h2&gt;

&lt;h3 id=&quot;section-3&quot;&gt;3.1 可测试性&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级1&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;测试是验证体系安全和质量的最后一道屏障，&lt;/li&gt;
  &lt;li&gt;必须首先建立对体系安全评估的测试能力。&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-4&quot;&gt;先想好怎么测试和验证，再思考开发实现&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;因为在一开始几乎不可能有充足资源搭建强有力的测试团队。技术团队，尤其要建立这样的团队意识和基本的技术支撑。否则，随着业务功能的演进，技术团队必然陷入忙于救火，甚至乱上加乱的态势。&lt;/p&gt;

&lt;h3 id=&quot;section-5&quot;&gt;3.2 可追溯性&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级1&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;安全的基石是所有系统和用户行为的可追溯。
    &lt;ul&gt;
      &lt;li&gt;没有相适应的追溯体系，监控、告警、分析、改进都会无从谈起。&lt;/li&gt;
      &lt;li&gt;运营层面的个案分析、责任划分甚至赔付等都难以开展。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;系统内数据和日志的完整性和不可抵赖性，是追溯合法性关键。&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-6&quot;&gt;日志记录的搜集、检索能力，是可追溯的技术基础&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;暂时没有完整的日志运用平台不要紧；没有现成日志记录规范也不要紧；检索起来有点笨拙也不太要紧；
但是技术团队在代码评审时候，必须意识到，某些代码段，必须要在运行时候，记录下点什么，并且确保能记录下来。&lt;/p&gt;

&lt;h3 id=&quot;section-7&quot;&gt;3.3 安全性&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级1&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;用户数据安全性
    &lt;ul&gt;
      &lt;li&gt;涵盖：用户隐私数据、用户交易数据、用户认证数据&lt;/li&gt;
      &lt;li&gt;要求：展示层、存储层、内部交互层面、外部通信层面&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;系统交易安全性
    &lt;ul&gt;
      &lt;li&gt;人为操作导致的交易损失［主观故意｜过失］&lt;/li&gt;
      &lt;li&gt;系统BUG导致的交易损失［设计缺陷｜实现缺陷］&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-8&quot;&gt;建立多层次的防控体系， 对业务流程建立主题式风险表&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;用户数据的泄漏，已然是这几年见怪不怪的新闻了。泄漏事件一旦进入公众视野，对于平台业务的成长打击是显而易见的。很多时候，泄漏都不是源于技术高超的攻击，而不过是内部管理缺陷和安全意识的淡薄的结果。 &lt;br /&gt;
对成长中的团队，如果技术手段跟不上，那么先考虑实现基本的安全原则，以及更加严格的数据权限纪律1，2，3…。作为团队领导，必须有足够的安全敏感度，清晰的意识到哪些事情是必须首先做的。&lt;/p&gt;

&lt;h3 id=&quot;section-9&quot;&gt;3.4 可监控 可报警&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级1&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;可监控
    &lt;ul&gt;
      &lt;li&gt;对所有交易，尤其是“钱”相关的操作，能及时发现问题。&lt;br /&gt;
 &lt;em&gt;监控什么？ 怎么监控？ 投入多少资源？&lt;/em&gt;需要团队共同梳理清楚，排进工作中。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;可报警
    &lt;ul&gt;
      &lt;li&gt;报警的目的是避免风险扩大、蔓延.&lt;/li&gt;
      &lt;li&gt;确定处理策略的依据    &lt;br /&gt;
 &lt;em&gt;确定告警项 确定告警的依据模型  确定警告散发的方式&lt;/em&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-10&quot;&gt;确定优先级表格，技术研发和运营、运维要结合联动&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;信息安全体系的构建是全平台包括技术研发、运维、业务运营及客户服务等各个团队的职责。对于快速成长的平台，尤其需要高效联动，才能保证问题早发现，响应处理更高效。从而，满足用户的安全感诉求、保证用户体验，维护用户对平台的信任感。&lt;/p&gt;

&lt;h3 id=&quot;section-11&quot;&gt;3.5 内部操作安全性&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级1&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;上线操作风险&lt;/li&gt;
  &lt;li&gt;生产环境变更风险／配置管理风险&lt;/li&gt;
  &lt;li&gt;跨流程（跨产品线）交易修改操作风险&lt;/li&gt;
  &lt;li&gt;代码审核风险［如测试代码和参数被发布上线］&lt;/li&gt;
  &lt;li&gt;测试风险［如测试数据］&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-12&quot;&gt;建立明确、合理、严格的操作和评审规范&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;制度和规范的建立需要一个过程。从别的团队照搬过来的一整套貌似完整的制度规范，在创业团队中，多数会成为摆设。若干条切中要害的研发纪律产生的效果可以是立竿见影的。从简单的几条研发纪律开始，逐步演进，完善，最终可以形成操作性强，适应实际的规范和制度。&lt;/p&gt;

&lt;h3 id=&quot;section-13&quot;&gt;3.6 系统基本自我保护能力&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级1&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;容错能力
    &lt;ul&gt;
      &lt;li&gt;发生预期失败时，系统自己解决问题，防止应用失败。 &lt;br /&gt;
   &lt;code class=&quot;highlighter-rouge&quot;&gt;比如自动路由功能，保证一个通道失败时，寻找新通道等。&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;快速失败原则
    &lt;ul&gt;
      &lt;li&gt;防止系统进入不完整运行态（比如半吊子流程）&lt;/li&gt;
      &lt;li&gt;防止因为某个失败、系统进入无休止的等待（比如利用超时设置）&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;服务降级
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;当服务的访问量超出预期吞吐能力时，通过降级来保证服务质量，而不是让服务不降级但全部不可 &lt;br /&gt;
  &lt;code class=&quot;highlighter-rouge&quot;&gt;降级策略不是个单纯技术问题，典型问题如：ERP库存无法读取时，是否在线商城就不让购买了？？&lt;/code&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;自动降级还是手动降级，也是一个问题。&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;资源限制与管控
    &lt;ul&gt;
      &lt;li&gt;系统资源不做管控，一定会在某个时间点发生事故。 &lt;br /&gt;
   &lt;code class=&quot;highlighter-rouge&quot;&gt;管控资源的基本准则是不让局部出现资源短板，而导致体系崩溃。&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://www.zhongkerd.com/news/content-545.html&quot;&gt;关于降级的一篇参考的文档&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-14&quot;&gt;技术团队完全有责任不让用户陷入“系统又挂了”的惯性信任危机思维中&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;极端情况下，当内部业务和运营团队都有这样的思维惯性时，技术团队的工作开展将变得困难。重建信任的过程是异常困难的。&lt;br /&gt;
举个例子，如果在系统响应能力不够时，较之卡死不动，而是直接跳转到友情提示页面，带给用户的感觉是完全不同的。让用户清晰知道，当前平台的服务能力是有限的，这不丢人，用户多数时候也会理解；但是绝不能让用户感觉到，技术团队对平台的状态是茫然和失控的。&lt;/p&gt;

&lt;h3 id=&quot;section-15&quot;&gt;3.7 避免雪崩效应&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级2&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;所有涉及到第三方的接入都要加入防雪崩效应的策略&lt;/li&gt;
  &lt;li&gt;不能假设第三方服务不会延迟、宕机。&lt;/li&gt;
  &lt;li&gt;不能因为某个第三方服务的失败而拖垮平台本身。&lt;/li&gt;
  &lt;li&gt;不能因为某个用户的某些操作行为，而拖垮其它用户的正常交易。&lt;/li&gt;
  &lt;li&gt;对于不同类型、业务频率、实时性要求的业务，要放在不同消息通道里处理。&lt;/li&gt;
  &lt;li&gt;防止外挂系统来影响正常业务&lt;/li&gt;
  &lt;li&gt;如系统日志、监控等，目的是为了支撑业务系统，要防止反过来影响业务系统。&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-16&quot;&gt;建立对雪崩场景的压力测试用例，并进行测试&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;通过monk、压测，是在团队早期，功能上线频繁，需求不稳定，测试工作不完善的情况下，性价很高的早发现问题的方法。很大部分设计、代码的缺陷，在一定的压力下会比较容易暴露出来。&lt;/p&gt;

&lt;h3 id=&quot;section-17&quot;&gt;3.8 应对活动和促销&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级2&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;活动和促销带来的突发流量和并发的应对
    &lt;ul&gt;
      &lt;li&gt;结合压力测试和资源估算模型，建立对平台能力的基本判断&lt;/li&gt;
      &lt;li&gt;形成基本的活动和促销的方案预案［技术｜运营｜…］&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;部分商家的活动和促销对其他商家的资源挤占的应对
    &lt;ul&gt;
      &lt;li&gt;架构上，要具备基本的资源隔离能力（除非接入带宽被完全挤占）&lt;/li&gt;
      &lt;li&gt;降级和资源管控策略相集合。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-18&quot;&gt;需要从公司层面进行统筹&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;活动和促销，已经成为很多平台暴力演进的常态化工具。并非一般意义上的安全体系问题，但是往往会引发一些潜在安全漏洞的暴露。比如促销、优惠券使用存在的潜在漏洞；或者诱人的活动，引来一些潜在的系统攻击者；当然，也不排除一些恶意的刷爆平台第三方服务的预存款行为等。这些都需要技术团队事先有所预见。&lt;/p&gt;

&lt;h3 id=&quot;section-19&quot;&gt;3.9 可配置&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级2&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;业务层面系统参数的变化，尽量避免停机或者重启&lt;br /&gt;
 &lt;code class=&quot;highlighter-rouge&quot;&gt;如：关键服务的下架；部分系统进入维护，部分系统临时隔离等等&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;非功能性需求的实现，需要存在人工干预人口的场景&lt;br /&gt;
 &lt;code class=&quot;highlighter-rouge&quot;&gt;如：资源管控，降级策略的调整等等&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-20&quot;&gt;自动化当然好，但是很难一步到位；图形化当然好，但不是不可或缺&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;这个问题的本质，还是技术团队（包括运维），对平台的真正的控制力。这里控制力，不是说你有每个服务器的密码和服务重启的权限。而是你对你所有服务和每个服务在用、可用资源都能比较清晰的掌握，并在此基础上，可以实现高效的管控，调配。&lt;/p&gt;

&lt;h3 id=&quot;section-21&quot;&gt;3.10 避免单点故障&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;优先级2&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;单点的故障，往往不是预期会出现故障的故障点。 &lt;br /&gt;
 &lt;code class=&quot;highlighter-rouge&quot;&gt;往往也不是软件本身导致的故障&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;对于短时间无法消除的单点风险，要准备失败－恢复的可靠预案。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;section-22&quot;&gt;预案都需要真正演练过，以证明可行、可靠&lt;/h4&gt;
  &lt;hr /&gt;
&lt;/blockquote&gt;

&lt;p&gt;很多平台在发展初期，或多或少存在一些单点的风险。对这些高风险单点，需要单独加入一个风险关注清单，进行重点关注。并且制定一个逐步消除这类风险的中期时间表。&lt;/p&gt;

&lt;h2 id=&quot;section-23&quot;&gt;四 安全体系建设的日常工作策略&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;系统思考风险及优先级、建立风险应对和控制策略&lt;/li&gt;
  &lt;li&gt;不断从风险清单中整理出阶段任务清单，纳入工作计划&lt;/li&gt;
  &lt;li&gt;从团队建设层面的工作推动&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-24&quot;&gt;4.1 部分典型风险和风控工作建议&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;用户风险&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风险类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;典型风险&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风控内容及建议&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;关键信息泄漏&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;基本防护薄弱&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;从基本防护角度进行排查，保证通讯链路，APP端无明显泄漏&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;交易风险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;账户被盗&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;建立找回机制和强行密码重置。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;交易风险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;伪冒或交易抵赖&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;可追溯机制＋（运营）核查分析机制＋（运营）自证和赔付。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;卖家风险&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风险类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;典型风险&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风控内容及建议&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;交易风险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;交易抵赖&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;可追溯机制＋（运营）核查分析机制＋（运营）自证和赔付。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;操作风险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;误操作&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;对关键后台管理操作除了可追溯机制，对关键操作内容要加入（版本和备份策略）。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;法律合规风险&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风险类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;典型风险&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风控内容及建议&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;商家交易风险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;商品违规，套现／洗钱风险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;（从法律和运营角度需要有所预防）。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;平台内部风险&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风险类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;典型风险&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;风控内容及建议&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;人为信息泄漏&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;制度漏洞及权限管理松懈&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保密制度＋生产数据库操作权限管理 +涉密内容的加密策略。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;网站安全漏洞&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;攻击/恶意篡改&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;建立基本攻防体系，细化日常工作运维审计。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;section-25&quot;&gt;4.2 安全相关的阶段性工作任务分解 【举例】&lt;/h3&gt;

&lt;h4 id=&quot;section-26&quot;&gt;§ 提升可测试性&lt;/h4&gt;
&lt;p&gt;－ 调研影响测试效率和测试效果的关键薄弱点。 &lt;br /&gt;
－ 着重在测试生产力工具上进行储备和改善。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;参考方案／文献&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&quot;https://mqc.aliyun.com/security.htm&quot;&gt;阿里云测&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;http://www.jianshu.com/p/70ac552a797e&quot;&gt;Android APP mock测试索引&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;http://www.infoq.com/cn/articles/comparison-and-analysis-of-mobile-app-cloud-test-platform&quot;&gt;APP云测试平台比较&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;traceability&quot;&gt;§ 提高事件追溯能力    Traceability&lt;/h4&gt;
&lt;p&gt;－ 搭建统一的日志利用平台&lt;br /&gt;
－ 梳理需要追溯的流程事务、并明确粒度度和准确度准则  &lt;br /&gt;
－ 设定合适生产环境的日志的规范&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;参考方案／文献&lt;/strong&gt; &lt;br /&gt;
&lt;a href=&quot;http://www.jianshu.com/p/01b7cacfe202&quot;&gt;日志规范实践&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://testing.googleblog.com/2013/06/optimal-logging.html&quot;&gt;Optimal Logging&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;section-27&quot;&gt;§ 改善安全性&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;根据成熟的安全体系框架，确定每层的现阶段重点工作&lt;/li&gt;
  &lt;li&gt;系统安全层面：密码安全｜服务器漏洞｜内部信息安全防控｜常见攻击的防护能力｜审计制度&lt;/li&gt;
  &lt;li&gt;身份认证/证书： 认证｜证书安全｜认证过程安全&lt;/li&gt;
  &lt;li&gt;风险行为防控：恶意订单｜恶意注册 ｜验证码安全&lt;/li&gt;
  &lt;li&gt;风险策略制定：权限等级｜风险预案｜安全等级｜审计制度&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考方案／文献&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&quot;http://www.fmi.com.cn/index.php?m=content&amp;amp;c=index&amp;amp;a=show&amp;amp;catid=9&amp;amp;id=590845&quot;&gt;“互联网+”环境下信息安全的挑战与机遇&lt;/a&gt; &lt;br /&gt;
&lt;a href=&quot;http://www.cas.stc.sh.cn/jsjyup/pdf/2013/9/%BB%F9%D3%DAWPKI%B5%C4%D2%C6%B6%AF%B5%E7%D7%D3%C9%CC%CE%F1%B0%B2%C8%AB%D1%D0%BE%BF.pdf&quot;&gt;基于WPKI的移动电子商务安全研究&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;http://op.baidu.com/2015/04/https-s01a01/&quot;&gt;大型网站的 HTTPS 实践&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;section-28&quot;&gt;§ 提升监控／告警的能力&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;整理监控点，整理告警策略表&lt;/li&gt;
  &lt;li&gt;确定监控和补强策略（自建｜采购）。&lt;/li&gt;
  &lt;li&gt;验证监控和告警的有效性&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;参考方案／文献&lt;/strong&gt;  &lt;br /&gt;
&lt;a href=&quot;https://en.wikipedia.org/wiki/Application_performance_management&quot;&gt;Application performance management&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;section-29&quot;&gt;§ 团队建设方面&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;在团队内进行培训和宣讲，建立全员的安全意识&lt;/li&gt;
  &lt;li&gt;推动跨部门、团队的协调和联动机制的建立。&lt;/li&gt;
  &lt;li&gt;逐步建立制度，优先降低高风险的操作行为｛代码｜发布｜线上操作｜…｝等&lt;/li&gt;
  &lt;li&gt;在需求完善的工作中，加入非功能性需求的补全。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;*&lt;end&gt;*&lt;/end&gt;&lt;/p&gt;</content><author><name>Ryan Wang (Haide1977)</name><email>haide1977 AT gmail.com</email></author><category term="架构" /><category term="互联网" /><category term="基础系统" /><category term="安全" /><summary type="html">现在互联网的新生平台比以往面临着更复杂的技术环境。平台一上线，即面临着全方位、体系性的安全风险考验。以如下几方面情况的引入，可能衍生的安全风险尤为突出：


  面向多种类型端的用户APP产品入口的推出
  更加复杂的用户权益账户、储值类电子账户的引入， 如 积分、内置钱包等
  平台自有的多个支付渠道和多类型收付交易行为的引入， 如 三方支付、交易中途改变支付方式等
  更加复杂的结算和清算场景 ， 如 用户奖励提现，外部积分互换等
  更加复杂的业务和个性化的促销策略， 如 折扣策略、优惠券和羊毛党等
  以及，快速的业务场景和功能的演进。</summary></entry></feed>
